<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>CI360 – Teste Web (Identity + Click)</title>

  <!-- SAS CI360 Tag -->
  <script src="https://i-us.ci360.marketing/js/ot2.min.js"></script>

  <style>
    body { font-family: Arial; background:#f4f4f4; padding:40px; }
    .card { background:white; padding:20px; border-radius:8px; width:420px; }
    input { width:100%; padding:10px; margin-bottom:10px; }
    button { padding:10px; margin-right:8px; margin-top:8px; }
    .log { background:#081a33; color:#fff; padding:12px; margin-top:15px; height:150px; overflow:auto; }
    .ok { color:green; font-weight:bold; }
    .warn { color:red; font-weight:bold; }
  </style>
</head>

<body>

<div class="card">

  <h2>CI360 – Teste Web Oficial</h2>

  <p>Custom Event API key: <b>teste_sdk_ci360</b></p>

  <label>Identity (customer_id)</label>
  <input id="identityInput" placeholder="ex: RENAN_TESTE_001">

  <button onclick="setIdentity()">1) Set Identity</button>
  <button id="btn-ci360-evento" onclick="dispararEvento()">2) Disparar evento (Click)</button>

  <p id="status">Status: aguardando SDK...</p>

  <div class="log" id="log"></div>

</div>

<script>

let sdkReady = false

function log(msg){
  const el = document.getElementById('log')
  el.innerHTML += "["+new Date().toLocaleTimeString()+"] "+msg+"<br>"
  el.scrollTop = el.scrollHeight
}

function aguardarSDK(){
  if(window.ci360){
    sdkReady = true
    document.getElementById('status').innerHTML = "Status: SDK carregado"
    document.getElementById('status').className = "ok"
    log("SDK detectado (window.ci360 disponível)")
  } else {
    setTimeout(aguardarSDK, 500)
  }
}

aguardarSDK()

/* ===== IDENTITY ===== */
function setIdentity(){

  if(!sdkReady){
    log("SDK ainda não carregado")
    return
  }

  const val = document.getElementById('identityInput').value
  if(!val){
    log("Informe um customer_id")
    return
  }

  window.ci360_identity = val

  if(window.ci360 && window.ci360.setUser){
    window.ci360.setUser({ customer_id: val })
  }

  log("Identity definida: "+val)
}

/* ===== EVENTO CLICK ===== */
function dispararEvento(){

  if(!sdkReady){
    log("SDK ainda não carregado")
    return
  }

  if(!window.ci360_identity){
    log("Defina identity antes do evento")
    return
  }

  log("Click disparado — CI360 deve capturar via Click Event")

}

</script>

</body>
</html>
